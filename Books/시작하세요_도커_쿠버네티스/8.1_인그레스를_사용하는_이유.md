Ingress 는 일반적으로 외부에서 내부로 항하는 것을 지칭하는 단어.  

Service object 가 외부 요청을 받아들이기 위한 것이었다면 'Ingress'는 외부 요청을 어떻게 처리할 것인지 네트워크 7계층 레벨에서 정의하는 Kubernetes object 이다. 여기서 '처리한다'라는 문장에는 많은 기능이 내포돼 있는데, Ingress object가 담당할 수 있는 기본적인 기능만 간단히 날여하면 다음과 같다.  

- 외부 요청의 라우팅: `/apple`, `/appple/red` 등과 같이 특정 경로로 들어온 요청을 어떠한 서비스로 전달할지 정의하는 라우팅 규칙을 설정할 수 있다.
- 가상 호스트 기반의 요청 처리: 같은 IP에 대해 다른 도메인으로 요청이 도착했을때, 어떻게 처리할 것인지 정의할 수 있다.
- SSL/TLS 보안 연결 처리: 여러 개의 서비스로 요청을 라우팅할 때, 보안 연결을 위한 인증서를 쉽게 적용할 수 있다.

하지만 Ingress의 기능이 위 기능에만 제한되는 것은 아니며, Ingress를 어떻게 활용하냐에 따라 다양한 기능을 사용할 수 있다. Ingress 자체의 기능은 비교적 정해져 있더라도 Ingress의 요청을 처리할 서버로 무엇을 선택하느냐에 따라 기능이 조금씩 달라지기 때문이다.

# 8.1 Ingress를 사용하는 이유

위에 기능들만 봤을 때는 Ingress를 사용해야할 필요를 느끼지 못할 수도 있다. 이전에 사용해봤던 NodePort, LoadBalancer 타입의 Service를 사용해도 위 기능들을 구현하는 것이 불가능하지는 않기 때문이다. Ingress를 왜 사용해야 하는지 이해하기 위해 Ingress를 사용할때와 그렇지 않을때를 간단히 비교해 보겠다.

Application이 3개의 Deployment로 생성돼 있다고 가정해 보겠다. 각 Deployment를 외부에 노출해야 한다면 NodePort 또는 LoadBalancer 타입의 Service 3개를 생성해 각 Deployment에 대응할 수 있다.

위 방식은 Service마다 세부적인 설정을 할 때 추가적인 복잡성이 발생한다. SSL/TLS 보안 연결, 접근 도메인 및 클라이언트 상태에 기반한 라우팅 등을 구현하려면 각 Service와 Deployment에 대해 일일이 설정해야 하기 때문이다.

Ingress object를 사용하면 URL endpoint를 단 하나만 생성함으로써 이 번거로움을 쉽게 해결할 수 있다.

3개의 Service에 대해 3개의 URL이 각각 존재하는 것이 아닌 Ingress에 접근하기 위한 단 하나의 URL만 존재한다. 따라서 client는 Ingress의 URL로만 접근하게 되며, 해당 요청은 Ingress에 정의된 규칙에 따라 처리된 뒤 적절한 Deployment Pod로 전달된다.

이 과정에 중요한 점은 Routing 정의나 보안 연결 등과 같은 세부설정은 Service와 Deployment가 아닌 Ingress에 의해 수행된다는 점이다. 즉, 외부 요청에 대한 처리 규칙을 Kubernetes 자체의 기능으로 편리하게 관리할 수 있다는 것이 Ingress의 핵심이다.

